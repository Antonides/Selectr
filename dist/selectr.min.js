/*
 Selectr 2.4.7
 http://mobius.ovh/docs/selectr

 Released under the MIT license
*/
(function(g,k){"function"===typeof define&&define.amd?define([],k):"object"===typeof exports?module.exports=k("Selectr"):g.Selectr=k("Selectr")})(this,function(g){function k(a,b){return a.hasOwnProperty(b)&&(!0===a[b]||a[b].length)}function n(a,b,e){a.parentNode?a.parentNode.parentNode||b.appendChild(a.parentNode):b.appendChild(a);c.removeClass(a,"excluded");e||(a.innerHTML=a.textContent)}var t={defaultSelected:!0,width:"auto",disabled:!1,searchable:!0,clearable:!1,sortSelected:!1,allowDeselect:!1,
closeOnScroll:!1,nativeDropdown:!1,nativeKeyboard:!1,placeholder:"Select an option...",taggable:!1,tagPlaceholder:"Enter a tag...",messages:{noResults:"No results.",noOptions:"No options available.",maxSelections:"A maximum of {max} items can be selected.",tagDuplicate:"That tag is already in use."}},l=function(){};l.prototype={on:function(a,b){this._events=this._events||{};this._events[a]=this._events[a]||[];this._events[a].push(b)},off:function(a,b){this._events=this._events||{};!1!==a in this._events&&
this._events[a].splice(this._events[a].indexOf(b),1)},emit:function(a){this._events=this._events||{};if(!1!==a in this._events)for(var b=0;b<this._events[a].length;b++)this._events[a][b].apply(this,Array.prototype.slice.call(arguments,1))}};l.mixin=function(a){for(var b=["on","off","emit"],c=0;c<b.length;c++)"function"===typeof a?a.prototype[b[c]]=l.prototype[b[c]]:a[b[c]]=l.prototype[b[c]];return a};var c={extend:function(a,b){for(var e in b)if(b.hasOwnProperty(e)){var d=b[e];d&&"[object Object]"===
Object.prototype.toString.call(d)?(a[e]=a[e]||{},c.extend(a[e],d)):a[e]=d}return a},each:function(a,b,c){if("[object Object]"===Object.prototype.toString.call(a))for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&b.call(c,d,a[d],a);else{d=0;for(var e=a.length;d<e;d++)b.call(c,d,a[d],a)}},createElement:function(a,b){var c=document,d=c.createElement(a);if(b&&"[object Object]"===Object.prototype.toString.call(b))for(var f in b)if(f in d)d[f]=b[f];else if("html"===f)d.innerHTML=b[f];else if("text"===
f){var h=c.createTextNode(b[f]);d.appendChild(h)}else d.setAttribute(f,b[f]);return d},hasClass:function(a,b){if(a)return a.classList?a.classList.contains(b):!!a.className&&!!a.className.match(new RegExp("(\\s|^)"+b+"(\\s|$)"))},addClass:function(a,b){c.hasClass(a,b)||(a.classList?a.classList.add(b):a.className=a.className.trim()+" "+b)},removeClass:function(a,b){c.hasClass(a,b)&&(a.classList?a.classList.remove(b):a.className=a.className.replace(new RegExp("(^|\\s)"+b.split(" ").join("|")+"(\\s|$)",
"gi")," "))},closest:function(a,b){return a&&a!==document.body&&(b(a)?a:c.closest(a.parentNode,b))},isInt:function(a){return"number"===typeof a&&isFinite(a)&&Math.floor(a)===a},debounce:function(a,b,c){var d;return function(){var e=this,h=arguments,g=c&&!d;clearTimeout(d);d=setTimeout(function(){d=null;c||a.apply(e,h)},b);g&&a.apply(e,h)}},rect:function(a,c){var b=window,d=a.getBoundingClientRect(),f=c?b.pageXOffset:0;b=c?b.pageYOffset:0;return{bottom:d.bottom+b,height:d.height,left:d.left+f,right:d.right+
f,top:d.top+b,width:d.width}},includes:function(a,c){return-1<a.indexOf(c)},startsWith:function(a,c){return a.substr(0,c.length)===c},truncate:function(a){for(;a.firstChild;)a.removeChild(a.firstChild)}},p=function(){if(this.items.length){var a=document.createDocumentFragment();if(this.config.pagination){var b=this.pages.slice(0,this.pageIndex);c.each(b,function(b,d){c.each(d,function(d,c){n(c,a,this.customOption)},this)},this)}else c.each(this.items,function(c,d){n(d,a,this.customOption)},this);
a.childElementCount&&(c.removeClass(this.items[this.navIndex],"active"),this.navIndex=(a.querySelector(".selectr-option.selected")||a.querySelector(".selectr-option")).idx,c.addClass(this.items[this.navIndex],"active"));this.tree.appendChild(a)}},u=function(a){this.container.contains(a.target)||!this.opened&&!c.hasClass(this.container,"notice")||this.close()},m=function(a,b){var e=this.customOption?this.config.renderOption(b||a):a.textContent;e=c.createElement("li",{"class":"selectr-option",html:e,
role:"treeitem","aria-selected":!1});e.idx=a.idx;this.items.push(e);a.defaultSelected&&this.defaultSelected.push(a.idx);a.disabled&&(e.disabled=!0,c.addClass(e,"disabled"));return e},v=function(){this.requiresPagination=this.config.pagination&&0<this.config.pagination;k(this.config,"width")&&(c.isInt(this.config.width)?this.width=this.config.width+"px":"auto"===this.config.width?this.width="100%":c.includes(this.config.width,"%")&&(this.width=this.config.width));this.container=c.createElement("div",
{"class":"selectr-container"});this.config.customClass&&c.addClass(this.container,this.config.customClass);this.mobileDevice?c.addClass(this.container,"selectr-mobile"):c.addClass(this.container,"selectr-desktop");this.el.tabIndex=-1;this.config.nativeDropdown||this.mobileDevice?c.addClass(this.el,"selectr-visible"):c.addClass(this.el,"selectr-hidden");this.selected=c.createElement("div",{"class":"selectr-selected",disabled:this.disabled,tabIndex:0,"aria-expanded":!1});this.label=c.createElement(this.el.multiple?
"ul":"span",{"class":"selectr-label"});var a=c.createElement("div",{"class":"selectr-options-container"});this.tree=c.createElement("ul",{"class":"selectr-options",role:"tree","aria-hidden":!0,"aria-expanded":!1});this.notice=c.createElement("div",{"class":"selectr-notice"});this.el.setAttribute("aria-hidden",!0);this.disabled&&(this.el.disabled=!0);this.el.multiple&&(c.addClass(this.label,"selectr-tags"),c.addClass(this.container,"multiple"),this.tags=[],this.selectedValues=this.getSelectedProperties("value"),
this.selectedIndexes=this.getSelectedProperties("idx"));this.selected.appendChild(this.label);this.config.clearable&&(this.selectClear=c.createElement("button",{"class":"selectr-clear",type:"button"}),this.container.appendChild(this.selectClear),c.addClass(this.container,"clearable"));if(this.config.taggable){var b=c.createElement("li",{"class":"input-tag"});this.input=c.createElement("input",{"class":"selectr-tag-input",placeholder:this.config.tagPlaceholder,tagIndex:0,autocomplete:"off",autocorrect:"off",
autocapitalize:"off",spellcheck:"false",role:"textbox",type:"search"});b.appendChild(this.input);this.label.appendChild(b);c.addClass(this.container,"taggable");this.tagSeperators=[","];this.config.tagSeperators&&(this.tagSeperators=this.tagSeperators.concat(this.config.tagSeperators))}this.config.searchable&&(this.input=c.createElement("input",{"class":"selectr-input",tagIndex:-1,autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",role:"textbox",type:"search"}),this.inputClear=
c.createElement("button",{"class":"selectr-input-clear",type:"button"}),this.inputContainer=c.createElement("div",{"class":"selectr-input-container"}),this.inputContainer.appendChild(this.input),this.inputContainer.appendChild(this.inputClear),a.appendChild(this.inputContainer));a.appendChild(this.notice);a.appendChild(this.tree);this.items=[];this.options=[];this.el.options.length&&(this.options=[].slice.call(this.el.options));var e=!1,d=0;this.el.children.length&&c.each(this.el.children,function(a,
b){"OPTGROUP"===b.nodeName?(e=c.createElement("ul",{"class":"selectr-optgroup",role:"group",html:"<li class='selectr-optgroup--label'>"+b.label+"</li>"}),c.each(b.children,function(a,c){c.idx=d;e.appendChild(m.call(this,c,e));d++},this)):(b.idx=d,m.call(this,b),d++)},this);if(this.config.data&&Array.isArray(this.config.data)){this.data=[];var f=!1,h;e=!1;d=0;c.each(this.config.data,function(a,b){k(b,"children")?(f=c.createElement("optgroup",{label:b.text}),e=c.createElement("ul",{"class":"selectr-optgroup",
role:"group",html:"<li class='selectr-optgroup--label'>"+b.text+"</li>"}),c.each(b.children,function(a,b){h=new Option(b.text,b.value,!1,b.hasOwnProperty("selected")&&!0===b.selected);h.disabled=k(b,"disabled");this.options.push(h);f.appendChild(h);h.idx=d;e.appendChild(m.call(this,h,b));this.data[d]=b;d++},this),this.el.appendChild(f)):(h=new Option(b.text,b.value,!1,b.hasOwnProperty("selected")&&!0===b.selected),h.disabled=k(b,"disabled"),this.options.push(h),h.idx=d,m.call(this,h,b),this.data[d]=
b,d++)},this)}this.setSelected(!0);for(var g=this.navIndex=0;g<this.items.length;g++)if(b=this.items[g],!c.hasClass(b,"disabled")){c.addClass(b,"active");this.navIndex=g;break}this.requiresPagination&&(this.pageIndex=1,this.paginate());this.container.appendChild(this.selected);this.container.appendChild(a);this.placeEl=c.createElement("div",{"class":"selectr-placeholder"});this.setPlaceholder();this.selected.appendChild(this.placeEl);this.disabled&&this.disable();this.el.parentNode.insertBefore(this.container,
this.el);this.container.appendChild(this.el)},w=function(a){a=a||window.event;if(this.items.length&&this.opened&&c.includes([13,38,40],a.which)){a.preventDefault();if(13===a.which)return this.noResults||this.config.taggable&&0<this.input.value.length?!1:this.change(this.navIndex);var b=this.items[this.navIndex],e=this.navIndex;switch(a.which){case 38:var d=0;0<this.navIndex&&this.navIndex--;break;case 40:d=1,this.navIndex<this.items.length-1&&this.navIndex++}for(this.navigating=!0;c.hasClass(this.items[this.navIndex],
"disabled")||c.hasClass(this.items[this.navIndex],"excluded");){if(0<this.navIndex&&this.navIndex<this.items.length-1)d?this.navIndex++:this.navIndex--;else{this.navIndex=e;break}if(this.searching)if(this.navIndex>this.tree.lastElementChild.idx){this.navIndex=this.tree.lastElementChild.idx;break}else if(this.navIndex<this.tree.firstElementChild.idx){this.navIndex=this.tree.firstElementChild.idx;break}}a=c.rect(this.items[this.navIndex]);d?(0===this.navIndex?this.tree.scrollTop=0:a.top+a.height>this.optsRect.top+
this.optsRect.height&&(this.tree.scrollTop+=a.top+a.height-(this.optsRect.top+this.optsRect.height)),this.navIndex===this.tree.childElementCount-1&&this.requiresPagination&&r.call(this)):0===this.navIndex?this.tree.scrollTop=0:0>a.top-this.optsRect.top&&(this.tree.scrollTop+=a.top-this.optsRect.top);b&&c.removeClass(b,"active");c.addClass(this.items[this.navIndex],"active")}else this.navigating=!1},x=function(a){var b=this,e=document.createDocumentFragment(),d=this.options[a.idx],f=this.data?this.data[a.idx]:
d;f=this.customSelected?this.config.renderSelection(f):d.textContent;f=c.createElement("li",{"class":"selectr-tag",html:f});var h=c.createElement("button",{"class":"selectr-tag-remove",type:"button"});f.appendChild(h);f.idx=a.idx;f.tag=d.value;this.tags.push(f);if(this.config.sortSelected){a=this.tags.slice();var g=function(a,b){a.replace(/(\d+)|(\D+)/g,function(a,d,c){b.push([d||Infinity,c||""])})};a.sort(function(a,d){var c=[],e=[];if(!0===b.config.sortSelected){var f=a.tag;var h=d.tag}else"text"===
b.config.sortSelected&&(f=a.textContent,h=d.textContent);g(f,c);for(g(h,e);c.length&&e.length;)if(f=c.shift(),h=e.shift(),f=f[0]-h[0]||f[1].localeCompare(h[1]))return f;return c.length-e.length});c.each(a,function(a,b){e.appendChild(b)});this.label.innerHTML=""}else e.appendChild(f);this.config.taggable?this.label.insertBefore(e,this.input.parentNode):this.label.appendChild(e)},y=function(a){var b=!1;c.each(this.tags,function(c,d){d.idx===a.idx&&(b=d)},this);b&&(this.label.removeChild(b),this.tags.splice(this.tags.indexOf(b),
1))},r=function(){var a=this.tree;if(a.scrollTop>=a.scrollHeight-a.offsetHeight&&this.pageIndex<this.pages.length){var b=document.createDocumentFragment();c.each(this.pages[this.pageIndex],function(a,c){n(c,b,this.customOption)},this);a.appendChild(b);this.pageIndex++;this.emit("selectr.paginate",{items:this.items.length,total:this.data.length,page:this.pageIndex,pages:this.pages.length})}},q=function(){if(this.config.searchable||this.config.taggable)this.input.value=null,this.searching=!1,this.config.searchable&&
c.removeClass(this.inputContainer,"active"),c.hasClass(this.container,"notice")&&(c.removeClass(this.container,"notice"),c.addClass(this.container,"open"),this.input.focus()),c.each(this.items,function(a,b){c.removeClass(b,"excluded");this.customOption||(b.innerHTML=b.textContent)},this)};g=function(a,b){b=b||{};if(!a)throw Error("You must supply either a HTMLSelectElement or a CSS3 selector string.");this.el=a;"string"===typeof a&&(this.el=document.querySelector(a));if(null===this.el)throw Error("The element you passed to Selectr can not be found.");
if("select"!==this.el.nodeName.toLowerCase())throw Error("The element you passed to Selectr is not a HTMLSelectElement.");this.render(b)};g.prototype.render=function(a){if(!this.rendered){this.el.selectr=this;this.config=c.extend(t,a);this.originalType=this.el.type;this.originalIndex=this.el.tabIndex;this.defaultSelected=[];this.originalOptionCount=this.el.options.length;if(this.config.multiple||this.config.taggable)this.el.multiple=!0;this.disabled=k(this.config,"disabled");this.opened=!1;this.config.taggable&&
(this.config.searchable=!1);this.mobileDevice=this.navigating=!1;/Android|webOS|iPhone|iPad|BlackBerry|Windows Phone|Opera Mini|IEMobile|Mobile/i.test(navigator.userAgent)&&(this.mobileDevice=!0);this.customOption=this.config.hasOwnProperty("renderOption")&&"function"===typeof this.config.renderOption;this.customSelected=this.config.hasOwnProperty("renderSelection")&&"function"===typeof this.config.renderSelection;this.supportsEventPassiveOption=this.detectEventPassiveOption();l.mixin(this);v.call(this);
this.bindEvents();this.update();this.optsRect=c.rect(this.tree);this.rendered=!0;this.el.multiple||(this.el.selectedIndex=this.selectedIndex);var b=this;setTimeout(function(){b.emit("selectr.init")},20)}};g.prototype.getSelected=function(){return this.el.querySelectorAll("option:checked")};g.prototype.getSelectedProperties=function(a){var b=this.getSelected();return[].slice.call(b).map(function(b){return b[a]}).filter(function(a){return null!==a&&void 0!==a})};g.prototype.detectEventPassiveOption=
function(){var a=!1;try{var b=Object.defineProperty({},"passive",{get:function(){a=!0}});window.addEventListener("test",null,b)}catch(e){}return a};g.prototype.bindEvents=function(){var a=this;this.events={};this.events.dismiss=u.bind(this);this.events.navigate=w.bind(this);this.events.reset=this.reset.bind(this);if(this.config.nativeDropdown||this.mobileDevice){this.container.addEventListener("touchstart",function(b){b.changedTouches[0].target===a.el&&a.toggle()},this.supportsEventPassiveOption?
{passive:!0}:!1);this.container.addEventListener("click",function(b){b.target===a.el&&a.toggle()});var b=function(a,b){for(var c=[],d=a.slice(0),e,f=0;f<b.length;f++)e=d.indexOf(b[f]),-1<e?d.splice(e,1):c.push(b[f]);return[c,d]};this.el.addEventListener("change",function(d){a.el.multiple?(d=a.getSelectedProperties("idx"),d=b(a.selectedIndexes,d),c.each(d[0],function(b,c){a.select(c)},a),c.each(d[1],function(b,c){a.deselect(c)},a)):-1<a.el.selectedIndex&&a.select(a.el.selectedIndex)})}this.container.addEventListener("keydown",
function(b){"Escape"===b.key&&a.close();"Enter"===b.key&&a.selected===document.activeElement&&"undefined"!==typeof a.el.form.submit&&a.el.form.submit();" "!==b.key&&"ArrowUp"!==b.key&&"ArrowDown"!==b.key||a.selected!==document.activeElement||(setTimeout(function(){a.toggle()},200),a.config.nativeDropdown&&setTimeout(function(){a.el.focus()},200))});this.selected.addEventListener("click",function(b){a.disabled||a.toggle();b.preventDefault()});if(this.config.nativeKeyboard){var e="";this.selected.addEventListener("keydown",
function(b){if(!(a.disabled||a.selected!==document.activeElement||b.altKey||b.ctrlKey||b.metaKey))if(" "===b.key||!a.opened&&-1<["Enter","ArrowUp","ArrowDown"].indexOf(b.key))a.toggle(),b.preventDefault(),b.stopPropagation();else if(2>=b.key.length&&String[String.fromCodePoint?"fromCodePoint":"fromCharCode"](b.key[String.codePointAt?"codePointAt":"charCodeAt"](0))===b.key){if(a.config.multiple)a.open(),a.config.searchable&&(a.input.value=b.key,a.input.focus(),a.search(null,!0));else{e+=b.key;var c=
a.search(e,!0);c&&c.length&&(a.clear(),a.setValue(c[0].value));setTimeout(function(){e=""},1E3)}b.preventDefault();b.stopPropagation()}});this.container.addEventListener("keyup",function(b){a.opened&&"Escape"===b.key&&(a.close(),b.stopPropagation(),a.selected.focus())})}this.label.addEventListener("click",function(b){c.hasClass(b.target,"selectr-tag-remove")&&a.deselect(b.target.parentNode.idx)});this.selectClear&&this.selectClear.addEventListener("click",this.clear.bind(this));this.tree.addEventListener("mousedown",
function(a){a.preventDefault()});this.tree.addEventListener("click",function(b){var d=c.closest(b.target,function(a){return a&&c.hasClass(a,"selectr-option")});d&&!c.hasClass(d,"disabled")&&(c.hasClass(d,"selected")?(a.el.multiple||!a.el.multiple&&a.config.allowDeselect)&&a.deselect(d.idx):a.select(d.idx),a.opened&&!a.el.multiple&&a.close());b.preventDefault();b.stopPropagation()});this.tree.addEventListener("mouseover",function(b){c.hasClass(b.target,"selectr-option")&&!c.hasClass(b.target,"disabled")&&
(c.removeClass(a.items[a.navIndex],"active"),c.addClass(b.target,"active"),a.navIndex=[].slice.call(a.items).indexOf(b.target))});this.config.searchable&&(this.input.addEventListener("focus",function(b){a.searching=!0}),this.input.addEventListener("blur",function(b){a.searching=!1}),this.input.addEventListener("keyup",function(b){a.search();a.config.taggable||(this.value.length?c.addClass(this.parentNode,"active"):c.removeClass(this.parentNode,"active"))}),this.inputClear.addEventListener("click",
function(b){a.input.value=null;q.call(a);a.tree.childElementCount||p.call(a)}));this.config.taggable&&this.input.addEventListener("keyup",function(b){a.search();if(a.config.taggable&&this.value.length){var d=this.value.trim();if(13===b.which||c.includes(a.tagSeperators,b.key))c.each(a.tagSeperators,function(a,b){d=d.replace(b,"")}),a.add({value:d,text:d,selected:!0},!0)?(a.close(),q.call(a)):(this.value="",a.setMessage(a.config.messages.tagDuplicate))}});this.update=c.debounce(function(){a.opened&&
a.config.closeOnScroll&&a.close();a.width&&(a.container.style.width=a.width);a.invert()},50);this.requiresPagination&&(this.paginateItems=c.debounce(function(){r.call(this)},50),this.tree.addEventListener("scroll",this.paginateItems.bind(this)));document.addEventListener("click",this.events.dismiss);window.addEventListener("keydown",this.events.navigate);window.addEventListener("resize",this.update);window.addEventListener("scroll",this.update);this.on("selectr.destroy",function(){document.removeEventListener("click",
this.events.dismiss);window.removeEventListener("keydown",this.events.navigate);window.removeEventListener("resize",this.update);window.removeEventListener("scroll",this.update)});this.el.form&&(this.el.form.addEventListener("reset",this.events.reset),this.on("selectr.destroy",function(){this.el.form.removeEventListener("reset",this.events.reset)}))};g.prototype.setSelected=function(a){this.config.data||this.el.multiple||!this.el.options.length||(0!==this.el.selectedIndex||this.el.options[0].defaultSelected||
this.config.defaultSelected||(this.el.selectedIndex=-1),this.selectedIndex=this.el.selectedIndex,-1<this.selectedIndex&&this.select(this.selectedIndex));this.config.multiple&&"select-one"===this.originalType&&!this.config.data&&this.el.options[0].selected&&!this.el.options[0].defaultSelected&&(this.el.options[0].selected=!1);c.each(this.options,function(a,b){b.selected&&b.defaultSelected&&this.select(b.idx)},this);this.config.selectedValue&&this.setValue(this.config.selectedValue);if(this.config.data){!this.el.multiple&&
this.config.defaultSelected&&0>this.el.selectedIndex&&this.select(0);var b=0;c.each(this.config.data,function(a,d){k(d,"children")?c.each(d.children,function(a,c){c.hasOwnProperty("selected")&&!0===c.selected&&this.select(b);b++},this):(d.hasOwnProperty("selected")&&!0===d.selected&&this.select(b),b++)},this)}};g.prototype.destroy=function(){this.rendered&&(this.emit("selectr.destroy"),"select-one"===this.originalType&&(this.el.multiple=!1),this.config.data&&(this.el.innerHTML=""),c.removeClass(this.el,
"selectr-hidden"),this.container.parentNode.replaceChild(this.el,this.container),this.rendered=!1,delete this.el.selectr)};g.prototype.change=function(a){var b=this.items[a],e=this.options[a];e.disabled||(e.selected&&c.hasClass(b,"selected")?this.deselect(a):this.select(a),this.opened&&!this.el.multiple&&this.close())};g.prototype.select=function(a){var b=this.items[a],e=[].slice.call(this.el.options),d=this.options[a];if(this.el.multiple){if(c.includes(this.selectedIndexes,a))return!1;if(this.config.maxSelections&&
this.tags.length===this.config.maxSelections)return this.setMessage(this.config.messages.maxSelections.replace("{max}",this.config.maxSelections),!0),!1;this.selectedValues.push(d.value);this.selectedIndexes.push(a);x.call(this,b)}else{var f=this.data?this.data[a]:d;this.label.innerHTML=this.customSelected?this.config.renderSelection(f):d.textContent;this.selectedValue=d.value;this.selectedIndex=a;c.each(this.options,function(b,d){var e=this.items[b];b!==a&&(e&&c.removeClass(e,"selected"),d.selected=
!1,d.removeAttribute("selected"))},this)}c.includes(e,d)||this.el.add(d);b.setAttribute("aria-selected",!0);c.addClass(b,"selected");c.addClass(this.container,"has-selected");d.selected=!0;d.setAttribute("selected","");this.emit("selectr.change",d);this.emit("selectr.select",d);"createEvent"in document?(b=document.createEvent("HTMLEvents"),b.initEvent("change",!0,!0),this.el.dispatchEvent(b)):this.el.fireEvent("onchange")};g.prototype.deselect=function(a,b){var e=this.items[a],d=this.options[a];if(this.el.multiple){var f=
this.selectedIndexes.indexOf(a);this.selectedIndexes.splice(f,1);f=this.selectedValues.indexOf(d.value);this.selectedValues.splice(f,1);y.call(this,e);this.tags.length||c.removeClass(this.container,"has-selected")}else{if(!b&&!this.config.clearable&&!this.config.allowDeselect)return!1;this.label.innerHTML="";this.selectedValue=null;this.el.selectedIndex=this.selectedIndex=-1;c.removeClass(this.container,"has-selected")}this.items[a].setAttribute("aria-selected",!1);c.removeClass(this.items[a],"selected");
d.selected=!1;d.removeAttribute("selected");this.emit("selectr.change",null);this.emit("selectr.deselect",d);"createEvent"in document?(e=document.createEvent("HTMLEvents"),e.initEvent("change",!0,!0),this.el.dispatchEvent(e)):this.el.fireEvent("onchange")};g.prototype.setValue=function(a){var b=Array.isArray(a);b||(a=a.toString().trim());if(!this.el.multiple&&b)return!1;c.each(this.options,function(c,d){(b&&-1<a.indexOf(d.value)||d.value===a)&&this.change(d.idx)},this)};g.prototype.getValue=function(a,
b){if(this.el.multiple)if(a){if(this.selectedIndexes.length){var e={values:[]};c.each(this.selectedIndexes,function(a,b){var c=this.options[b];e.values[a]={value:c.value,text:c.textContent}},this)}}else e=this.selectedValues.slice();else if(a){var d=this.options[this.selectedIndex];e={value:d.value,text:d.textContent}}else e=this.selectedValue;a&&b&&(e=JSON.stringify(e));return e};g.prototype.add=function(a,b){if(a){this.data=this.data||[];this.items=this.items||[];this.options=this.options||[];if(Array.isArray(a))c.each(a,
function(a,c){this.add(c,b)},this);else if("[object Object]"===Object.prototype.toString.call(a)){if(b){var e=!1;c.each(this.options,function(b,c){c.value.toLowerCase()===a.value.toLowerCase()&&(e=!0)});if(e)return!1}var d=c.createElement("option",a);this.data.push(a);this.options.push(d);d.idx=0<this.options.length?this.options.length-1:0;m.call(this,d);a.selected&&this.select(d.idx);this.setPlaceholder();return d}this.config.pagination&&this.paginate();return!0}};g.prototype.remove=function(a){var b=
[];Array.isArray(a)?c.each(a,function(a,e){c.isInt(e)?b.push(this.getOptionByIndex(e)):"string"===typeof e&&b.push(this.getOptionByValue(e))},this):c.isInt(a)?b.push(this.getOptionByIndex(a)):"string"===typeof a&&b.push(this.getOptionByValue(a));if(b.length){var e;c.each(b,function(a,b){e=b.idx;this.el.remove(b);this.options.splice(e,1);var d=this.items[e].parentNode;d&&d.removeChild(this.items[e]);this.items.splice(e,1);c.each(this.options,function(a,b){b.idx=a;this.items[a].idx=a},this)},this);
this.setPlaceholder();this.config.pagination&&this.paginate()}};g.prototype.removeAll=function(){this.clear(!0);c.each(this.el.options,function(a,b){this.el.remove(b)},this);c.truncate(this.tree);this.items=[];this.options=[];this.data=[];this.navIndex=0;this.requiresPagination&&(this.requiresPagination=!1,this.pageIndex=1,this.pages=[]);this.setPlaceholder()};g.prototype.search=function(a,b){if(!this.navigating){var e=!1;a||(a=this.input.value,e=!0,this.removeMessage(),c.truncate(this.tree));var d=
[],f=document.createDocumentFragment();a=a.trim().toLowerCase();if(0<a.length){var g=b?c.startsWith:c.includes;c.each(this.options,function(b,h){var k=this.items[h.idx];if(g(h.textContent.trim().toLowerCase(),a)&&!h.disabled){if(d.push({text:h.textContent,value:h.value}),e&&(n(k,f,this.customOption),c.removeClass(k,"excluded"),!this.customOption)){var l=(l=(new RegExp(a,"i")).exec(h.textContent))?h.textContent.replace(l[0],"<span class='selectr-match'>"+l[0]+"</span>"):!1;k.innerHTML=l}}else e&&c.addClass(k,
"excluded")},this);if(e){if(f.childElementCount){var k=this.items[this.navIndex],l=f.querySelector(".selectr-option:not(.excluded)");this.noResults=!1;c.removeClass(k,"active");this.navIndex=l.idx;c.addClass(l,"active")}else this.config.taggable||(this.noResults=!0,this.setMessage(this.config.messages.noResults));this.tree.appendChild(f)}}else p.call(this);return d}};g.prototype.toggle=function(){this.disabled||(this.opened?this.close():this.open())};g.prototype.open=function(){var a=this;if(!this.options.length)return!1;
this.opened||this.emit("selectr.open");this.opened=!0;this.mobileDevice||this.config.nativeDropdown?(c.addClass(this.container,"native-open"),this.config.data&&c.each(this.options,function(a,c){this.el.add(c)},this)):(c.addClass(this.container,"open"),p.call(this),this.invert(),this.tree.scrollTop=0,c.removeClass(this.container,"notice"),this.selected.setAttribute("aria-expanded",!0),this.tree.setAttribute("aria-hidden",!1),this.tree.setAttribute("aria-expanded",!0),this.config.searchable&&!this.config.taggable&&
setTimeout(function(){a.input.focus();a.input.tabIndex=0},10))};g.prototype.close=function(){this.opened&&this.emit("selectr.close");this.navigating=this.opened=!1;if(this.mobileDevice||this.config.nativeDropdown)c.removeClass(this.container,"native-open");else{var a=c.hasClass(this.container,"notice");this.config.searchable&&!a&&(this.input.blur(),this.input.tabIndex=-1,this.searching=!1);a&&(c.removeClass(this.container,"notice"),this.notice.textContent="");c.removeClass(this.container,"open");
c.removeClass(this.container,"native-open");this.selected.setAttribute("aria-expanded",!1);this.tree.setAttribute("aria-hidden",!0);this.tree.setAttribute("aria-expanded",!1);c.truncate(this.tree);q.call(this);this.selected.focus()}};g.prototype.enable=function(){this.disabled=!1;this.el.disabled=!1;this.selected.tabIndex=this.originalIndex;this.el.multiple&&c.each(this.tags,function(a,b){b.lastElementChild.tabIndex=0});c.removeClass(this.container,"selectr-disabled")};g.prototype.disable=function(a){a||
(this.el.disabled=!0);this.selected.tabIndex=-1;this.el.multiple&&c.each(this.tags,function(a,c){c.lastElementChild.tabIndex=-1});this.disabled=!0;c.addClass(this.container,"selectr-disabled")};g.prototype.reset=function(){this.disabled||(this.clear(),this.setSelected(!0),c.each(this.defaultSelected,function(a,b){this.select(b)},this),this.emit("selectr.reset"))};g.prototype.clear=function(a){this.el.multiple?this.selectedIndexes.length&&(a=this.selectedIndexes.slice(),c.each(a,function(a,c){this.deselect(c)},
this)):-1<this.selectedIndex&&this.deselect(this.selectedIndex,a);this.emit("selectr.clear")};g.prototype.serialise=function(a){var b=[];c.each(this.options,function(a,c){var d={value:c.value,text:c.textContent};c.selected&&(d.selected=!0);c.disabled&&(d.disabled=!0);b[a]=d});return a?JSON.stringify(b):b};g.prototype.serialize=function(a){return this.serialise(a)};g.prototype.setPlaceholder=function(a){a=a||this.config.placeholder||this.el.getAttribute("placeholder");this.options.length||(a=this.config.messages.noOptions);
this.placeEl.innerHTML=a};g.prototype.paginate=function(){if(this.items.length){var a=this;return this.pages=this.items.map(function(b,c){return 0===c%a.config.pagination?a.items.slice(c,c+a.config.pagination):null}).filter(function(a){return a})}};g.prototype.setMessage=function(a,b){b&&this.close();c.addClass(this.container,"notice");this.notice.textContent=a};g.prototype.removeMessage=function(){c.removeClass(this.container,"notice");this.notice.innerHTML=""};g.prototype.invert=function(){var a=
c.rect(this.selected);a.top+a.height+this.tree.parentNode.offsetHeight>window.innerHeight?(c.addClass(this.container,"inverted"),this.isInverted=!0):(c.removeClass(this.container,"inverted"),this.isInverted=!1);this.optsRect=c.rect(this.tree)};g.prototype.getOptionByIndex=function(a){return this.options[a]};g.prototype.getOptionByValue=function(a){for(var b=!1,c=0,d=this.options.length;c<d;c++)if(this.options[c].value.trim()===a.toString().trim()){b=this.options[c];break}return b};return g});